<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Belerofontech - Introducci√≥n a la programaci√≥n con Python - M√≥dulo 5</title>
    <link rel="icon" type="image/png" href="favicon.ico" sizes="any">
    <!-- NOTE: the next line will be (or has been) replaced by the contents of src/slide.css -->
    <style>*{margin:0;padding:0;box-sizing:border-box}#slide{display:none}.slide{white-space:nowrap}.slide-content{align-self:center}@media screen{body{position:absolute;top:50%;left:50%}.slide-3x2{width:1020px;height:680px;margin:-340px 0 0 -510px}.slide-4x3{width:1024px;height:768px;margin:-384px 0 0 -512px}.slide-16x9{width:1024px;height:576px;margin:-288px 0 0 -512px}.slide-16x10{width:1024px;height:640px;margin:-320px 0 0 -512px}.slide{position:absolute;width:100%;height:100%;display:flex;justify-content:center;overflow:hidden}}@media print{body{transform:none!important}img{transform:none!important;min-width:200px;width:100%;display:flex}h1{font-size:1.8rem;line-height:1.5;letter-spacing:-.05rem;font-weight:300}.slide-root{width:100%;display:flex;flex-wrap:wrap;align-items:stretch}.slide-content{transform:none!important}.slide{display:flex;justify-content:center;flex:1;padding:.5rem;margin:.5rem .5rem 4rem .5rem;border:1px solid rgba(0,0,0,.2);visibility:visible!important}}</style>
    <!-- NOTE: the next line will load the specific CSS file samefilename.html.css -->
    <script>var scrname = window.location.pathname.split('/').pop(); document.getElementsByTagName("head")[0].insertAdjacentHTML("beforeend", "<link rel=\"stylesheet\" href=\"" + scrname + ".css\"/>");</script>
    <!-- NOTE: the next line will load the CSS file customization.css (just this or the previous one is enough) -->
    <link rel="stylesheet" href="customization.css">
    <!-- NOTE: the next line will be (or has been) replaced by the contents of src/slide.js -->
    <!-- NOTE: change below to CLICK_NEXT=1 to restore the default advance-on-click behaviour... -->
    <!-- NOTE: change below to HISTORY=0 to avoid pushing browser history elements for each page change! -->
    <script>var CLICK_NEXT=0,HISTORY=1,slideNames={},currentSlide=-1,INDENT_RE=/^(?:( )+|\t+)/;function trimIndent(e){var t=(e.match(INDENT_RE)||[""])[0].length;if(t>0){var n="^"+e.substring(0,t);return e.replace(new RegExp(n,"mg"),"")}return e}function renderSlide(e,t,n){var i=t.split("\n"),s=-1,r=document.createElement("div"),o=document.createElement("div"),a="";r.className="slide slide-"+n,o.className="slide-content";for(var l=0;l<i.length;l++){var d=i[l];if(d.startsWith("#"))a=d.startsWith("##")?a+"<h2>"+d.substring(2).trim()+"</h2>":a+"<h1>"+d.substring(1).trim()+"</h1>";else if(d.startsWith("`")||d.startsWith("\t")||d.startsWith("  ")){var h;0==(h=d.startsWith("  ")?d.substring(2):d.substring(1)).length&&(h=" "),a=a+"<pre>"+h+"</pre>"}else if(d.startsWith("@NOSELECT@"))r.className+=" noselect";else if(d.startsWith("@NOSCALE@"))r.className+=" noscale",o.className="slide-content-noscale";else if(d.startsWith("@ZOOM@")){var c=d.substring(6).trim();r.className+=" zoom-"+c}else if(d.startsWith("@CLASS@")){var u=d.substring(7).trim();r.className+=" "+u,slideNames[u]=n}else if(d.startsWith("!"))a=a+'<img src="'+d.substring(1).trim()+'" />';else if(d.startsWith(":")){var m=d.substring(1).trim(),g='target="_blank"';m.startsWith("#")&&(g=""),a=a+'<a href="'+m+'" '+g+">"+m+"</a>",a+="<br>"}else if(d.startsWith("- "))a=a+"<ul><li>"+d.substring(1).trim()+"</li></ul>";else{if(d.startsWith("\x3c!--"))continue;var w=!0;d.startsWith(".")&&(d=d.substring(1)),"/NOBR/"==(d=d.trim()).substring(d.length-6,d.length)&&(w=!1,d=d.substring(0,d.length-6));for(var f=0;f<d.length;f++){var y=d.charAt(f);"*"==y?-1==s?s=(a+="<strong>").length:(s!=a.length?a+="</strong>":a=a.substring(0,a.length-8)+"*",s=-1):a+=y}0==w||"</blockquote>"==d.substring(d.length-13,d.length)||"</pre>"==d.substring(d.length-6,d.length)?a+="\x3c!-- nobr --\x3e":a+="<br>"}}o.innerHTML=a,r.style.visibility="hidden",r.appendChild(o),e.appendChild(r)}function render(e){var t=document.createElement("div");t.className="slide-root",document.body.appendChild(t);for(var n=(e=trimIndent(e)).split(new RegExp("^\n+","mg")),i=0;i<n.length;i++){renderSlide(t,n[i].trim(),i)}return t}function resize(){var e=window.innerWidth,t=window.innerHeight,n=document.body.offsetWidth,i=document.body.offsetHeight,s=e/t<n/i?e/n:t/i;document.body.style.transform="scale("+s+")",current()}function goTo(e){currentSlide>=0&&(1==HISTORY?window.location.hash=e:window.location.hash.replace(e),currentSlide=e);for(var t=document.querySelectorAll(".slide"),n=0;n<t.length;n++){var i=1,s=t[n],r=s.children[0],o=window.devicePixelRatio/10+.6;s.className.match("noscale")&&(o=1);var a=s.offsetWidth*o/r.offsetWidth,l=s.offsetHeight*o/r.offsetHeight;if(s.className.match("zoom-")){var d=s.className.match("zoom-.+")[0].split();(i*=(parseInt(d[0].substr(5))||100)/100)<.25?i=.25:i>4&&(i=4)}i*=Math.min(a,l),n==e?(r.style.transform="scale("+i+")",currentSlide>=0&&(s.style.visibility="")):s.style.visibility="hidden"}}function next(){goTo(Math.min(currentSlide+1,document.querySelectorAll(".slide").length-1))}function prev(){goTo(Math.max(currentSlide-1,0))}function current(){dest=currentSlide,max=document.querySelectorAll(".slide").length-1,goTo(Math.min(max,Math.max(dest,0)))}function readhash(){return dest=window.location.hash.substring(1)||"0",null!=slideNames[dest]&&(dest=slideNames[dest]),dest}function newhash(){-1!=currentSlide&&(dest=readhash(),max=document.querySelectorAll(".slide").length-1,goTo(Math.min(max,Math.max(dest,0))))}window.onload=function(){render(document.getElementById("slide").innerHTML);var e=readhash();resize(),currentSlide=e,CLICK_NEXT&&(window.onclick=next),window.onresize=resize,window.onwheel=function(e){window.event.ctrlKey||window.event.metaKey||window.event.altKey||(e.deltaY>0?next():prev())},window.onkeydown=function(e){window.event.ctrlKey||window.event.metaKey||window.event.altKey||(39==e.keyCode||40==e.keyCode||76==e.keyCode||74==e.keyCode||13==e.keyCode||34==e.keyCode||32==e.keyCode?next():37==e.keyCode||38==e.keyCode||72==e.keyCode||75==e.keyCode||8==e.keyCode||33==e.keyCode?prev():36==e.keyCode?goTo(0):27==e.keyCode&&(window.location.hash=currentSlide))},window.onhashchange=newhash,window.setTimeout(current,150)};</script>
    <style media="screen">@import url(https://fonts.googleapis.com/css?family=Lato:400,700&subset=latin,latin-ext);@import url(https://fonts.googleapis.com/css?family=Oswald:400,700);@import url(https://fonts.googleapis.com/css?family=Inconsolata);</style>
  </head>
  <body class="slide-16x9">
    <pre id="slide">
      # Introducci√≥n a la
      # programaci√≥n con Python
      .
      ## M√≥dulo 5. Funciones
      .
      `<div style="text-align: right;">¬© 2020 Pachi Sucunza, Belerofontech</div>
      `<div style="text-align: right;"><a href="mailto:pachi.sucunza@belerofontech.com" target="_blank">‚úâ</a> <a href="http://www.belerofontech.com" target="_blank">üîó</a> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" title="This work is licensed under a Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License">CC BY-NC-SA 4.0</a></div>

      # √çndice
        Concepto de funci√≥n
        Definir funciones. return
        Valor especial None
        Built-in functions
        Docstrings
        Par√°metros y argumentos
          Valor por defecto. Posicionales y por nombre
          *args y **kwargs
        Par√°metros por asignaci√≥n
        Alcance (scope)
          Composici√≥n. Anidaci√≥n
        Recursi√≥n o recursividad
        Iteradores
        Ejercicios extra
        Referencias
      @ZOOM@ 110

      # Concepto de funci√≥n
      Engloban a las funciones matem√°ticas, y tambi√©n m√°s cosas
      .
      Conjunto de sentencias que operan sobre un n√∫mero de entradas
      (par√°metros), aunque pueden ser 0, y opcionalmente devuelven
      un resultado (valor, que puede ser compuesto)
      Subprograma o subrutina: "caja negra" con un cierto algoritmo

      # Definir funciones. return
      Ejemplos:
        def myprint(x):
            print(">>", x, end='.')
        
        def multiply(a, b):
            return a * b
        
        def nullfunc():
            pass
      .
      Si no se indica nada, se devuelve None

      # Valor especial None
      Es un valor inmutable, que no es ni True ni False!
        None != True
        None != False
      Se usa para indicar valores o casos "fuera de rango",
      o para valores por defecto

      IMPORTANTE: siempre debe compararse mediante <samp>is</samp>
        In [30]: id(None)
        Out[30]: 10306432
        
        In [31]: a = None
        
        In [32]: id(a)
        Out[32]: 10306432
        
        In [33]: a == None  # funciona pero <u>no recomendado</u>
        Out[33]: True
        
        In [34]: a is None  # CORRECTO, mejor
        Out[34]: True

      Principio de abstracci√≥n (abstracci√≥n de [flujo de] control):
      "Each significant piece of functionality in a program should be implemented
      in just one place in the source code. Where similar functions are carried
      out by distinct pieces of code, it is generally beneficial to combine them
      into one by abstracting out the varying parts."
      -- Benjamin C. Pierce in <a href="https://en.wikipedia.org/wiki/Types_and_Programming_Languages" target="_blank">Types and Programming Languages (2002)</a>
      .
      Reutilizaci√≥n: "caja negra" que puede ser modificada/sustituida sin afectarnos
      .
      Pero recordar tambi√©n el "Principio KISS" (Keep it simple, stupid!)
      : https://en.wikipedia.org/wiki/KISS_principle

      # Built-in functions
      sum(), max(), min(), pow(), abs(), bool(), str(), int(),
      round(), hex(), bin(), chr(), len(), format(), help()...
      : https://www.w3schools.com/python/python_ref_functions.asp
      M√°s en detalle:
      : https://docs.python.org/3/library/functions.html

      Ejemplo: forma de uso de sum()
      Seg√∫n la Doc., su "interfaz" es:
        sum(iterable, /, start=0)
      .
      Devuelve la suma de lo que recibe ( + start,
      que es opcional) y si fuera vac√≠o, 0 + start
        sum(range(11))  # suma desde 0 a 10

      all()
      Devuelve True si TODOS los elementos de la secuencia lo son
      any()
      Devuelve True si ALG√öN elemento de la secuencia lo es
      Ejemplos:
        all([True, 1, 'a'])
        any([False, 0, 'a'])

      # Docstrings
        def myprint(x):
            """Es habitual indicar de esta forma
            lo que hace y c√≥mo usar esta funci√≥n...
            
            myprint(x), donde x es cualquier objeto
            que se puede convertir a str, lo escribe
            por pantalla con estilo tipo terminal"""
            print(">>", x, end='.')
      .
      Si est√° en el lugar correcto, una triple-quoted string
      se toma autom√°ticam. como Docstring para la funci√≥n

      # Par√°metros y argumentos
      Par√°metros: al definir la funci√≥n (recibidos)
      Argumentos: al invocarla (enviados / pasados)

      ## Valor por defecto
      Se puede asignar un valor que se tomar√°
      si se omite el argumento al invocar. Ejemplo:
        def add_vat(base, vat_type=21):
          return base * (100 + vat_type) / 100.0

      ## Posicionales
        def add_vat(base, vat_type=21):
          return base * (100 + vat_type) / 100.0
        add_vat(500, 10)
      ## Por nombre (keyword)
        add_vat(vat_type=10, base=500)
      Es decir, en el segundo caso el que invoca a la funci√≥n
      debe/puede ser consciente del nombre/signif. del par√°m.
      .
      IMPORTANTE: siempre primero los argumentos posicionales!

      <!-- EJERCICIO-PARA-CLASE (DEMO) -->
      # Ejercicio / demo: ROT13
      <blockquote>Escribir una funci√≥n print_rot13() que reciba una<br> /NOBR/
      cadena y la escriba por pantalla "encriptada" seg√∫n<br> /NOBR/
      el cifrado C√©sar con n=13, tambi√©n llamado ROT13.</blockquote>
      NOTA: en este caso es cifrado sim√©trico, ¬øpor qu√©?
      .
      : https://es.wikipedia.org/wiki/ROT13

      ## Limitar la forma de uso de par√°metros
      Avanzado, reciente (Python >= 3.8), se puede
      restringir el uso permitido de los par√°metros:
        # a y b son s√≥lo posicionales, d s√≥lo keyword
        def foo(a=0, b=0, /, c=0, *, d=0):
            print(a, b, c, d)
        foo(1, d=4, c=3)     # OK
        foo(a=1, 2, c=3, 4)  # ERROR (doble)!

      # Par√°metros por asignaci√≥n
      *IMPORTANTE:*
      Al argumento se le asigna el valor del par√°metro recibido.
      Pero el tipo de dato puede ser mutable (listas, objetos y
      diccionarios) y eso a veces no es intuitivo / sencillo.
      Dependiendo del efecto deseado, deberemos <u>hacer una copia</u>
      nueva dentro de la funci√≥n, para no alterar lo recibido!

      Ejemplo
        # Funci√≥n que modifica par√°metros recibidos
        def my_func(n, l):
            print(">>my_func():", n, l)
            n = 0
            l[0] = "hola"
        
        x = 5
        y = [ "hello" ]
        # Para entenderlo: como si al iniciar my_func() se hace: n, l = x, y
        my_func(x, y)
        print(x, y)

      <!-- EJERCICIO-PARA-CLASE -->
      # Ejercicio 1: borrar de una lista<a href="#ejercicio-1" class="link-anchor"> # </a>
      <blockquote>Hacer una funci√≥n similar a la del ejemplo anterior, pero<br> /NOBR/
      que elimine el primer elemento de una lista (recibida<br> /NOBR/
      como par√°metro), y luego la muestre por pantalla, sin<br> /NOBR/
      devolver nada. Quien la invoque deber√° "ver" los cambios<br> /NOBR/
      en la variable que pas√≥ a la funci√≥n como argumento.<br> /NOBR/
      Despu√©s, hacer otra funci√≥n similar pero que <u>no</u> provoque<br> /NOBR/
      cambios en las variables que se pasaron como argumento.</blockquote>
      Ejemplo de estructura para la funci√≥n y forma de usarla:
        def print_all_after_delete_first(l):
            ...
        
        lista = [1, 2, 3, 4, 5, 6]
        print_all_after_delete_first(lista)
        print(lista)  # comprobar si sigue completa o no...
      @CLASS@ ejercicio-1

      Avanzado: Pero... ¬øse pueden devolver valores (o usar
      par√°metros "de salida" o por ref. como en otros leng.)?
      S√≠, pasando argumentos que sean mutables, o bien,
      <u>mucho mejor</u>, devolviendo una tupla de n valores
      .
      O sea: en Python es habitual (y recom.) <u>devolver tuplas</u>
      .
      M√°s informaci√≥n y ejemplos:
      <a href="https://docs.python.org/3/faq/programming.html#how-do-i-write-a-function-with-output-parameters-call-by-reference" target="_blank">https://docs.python.org/faq/...</a>)

      # Alcance (scope)
      ## global vs. local
      Las variables (entre otras...) pueden ser globales o locales
      Ejemplo:
        x = 20 # global
        def f():
            z = 5  # local
            print(x)
        f()
        print(z)  # ERROR! aqu√≠ z no "existe"

      ## shadowing
        x = 20
        def f():
            z = 5
            x = 40
        f()
        print(x)
      Nombres definidos despu√©s en otro √°mbito pueden "ocultar" o "hacer sombra" a los 1<sup>os</sup>
      .
      Regla <u>importante para recordar (y simplificar)</u>: mejor no reutilizar nombres salvo para
      cosas que sean con certeza temporales (ejemplo: variables para iterar, etc.)
      .
      M√°s detalles (extenso) en:
      : https://realpython.com/python-namespaces-scope/

      <!-- EJERCICIO-PARA-CLASE -->
      # Ejercicio 2: funciones sencillas<a href="#ejercicio-2" class="link-anchor"> # </a>
      <blockquote>Crear una serie de <u>funciones</u> para acciones sencillas.</blockquote>
      - Calcular y devolver el √°rea de una circunferencia de radio r<br> (valor de r recibido como par√°metro)
      - Devolver la palabra m√°s larga de una lista de cadenas recibidas.
      - Devolver la longitud total de las palabras que contenga una<br> lista de cadenas recibidas.<br> Ejemplo: para ['hola', 'mundo'] deber√° devolver 9
      .
      Opcional: hacer adem√°s, <u>con funciones</u>, el primer ejercicio del
      libro "How to Think Like a Computer Scientist...", cap√≠tulo 4,
      dibujando con turtle. M√°s info en la p√°gina siguiente...
      @CLASS@ ejercicio-2

      .
      ! https://openbookproject.net/thinkcs/python/english3e/_images/five_squares.png
      Ver <a href="https://openbookproject.net/thinkcs/python/english3e/functions.html#exercises" target="_blank">openbookproject.net/.../functions.html</a>
      Ejemplo de base en: <a href="examples/turtle-square-exercise.py" target="_blank">turtle-square-exercise.py</a>
      .
      Mejora opcional: permitir dibujar 5 pol√≠gonos
      regulares de n lados (n recibido como par√°m.)

      ## Palabra clave <em>global</em>
      "...if you really do need to modify a value in the global scope from within
      a function, it is possible in Python using the global declaration:"
      Ejemplo:
        x = 20
        def f():
            # Para entender la diferencia, omitir la siguiente l√≠nea:
            <u>global</u> x
            x = 40
        f()
        print(x)

      ## Ejemplo: alcance
        # global
        text = 'this is a global variable'
        def justprint():
            print(1, text)  # se puede "leer" la global sin problema
        justprint()
        
        def my_func():
            def enclosing():
                # local
                text = 'this is a local variable'
                print(3, text)
            
            global text  # podremos leer y modificar la global
            print(2, text)
            enclosing()
            text = "modified"
            print(5, text)
        
        my_func()
        print(6, text)

      ## Ejemplo avanzado: alcance
        # built-in function range()
        print(range(5))
        
        # global
        range = 'this is a global "range"'  # OJO al nombre de la variable!
        print(range)
        
        def my_func():
            # enclosing
            range = 'this is an enclosed "range"'
            
            def enclosing():
                # local
                range = 'this is a local "range"'
                print(range)
             
            enclosing()  # no afectar√° a nuestra propia variable local
            print(range)
        
        my_func()
        range(0, 3)  # ERROR, ya no es una funci√≥n!!

      <!-- EJERCICIO-PARA-CLASE -->
      # Ejercicio 3: juego de la vida (parte 1)<a href="#ejercicio-3" class="link-anchor"> # </a>
      <blockquote>A partir del esqueleto inicial dado, modificarlo para<br> /NOBR/
      hacer una parte de la simulaci√≥n del juego de la vida.<br> /NOBR/
      Funci√≥n num_vecinos(m, x, y) que devuelve un entero<br> /NOBR/
      (rango 0..8) que indica el n√∫mero de vecinos de la<br> /NOBR/
      celda que ocupa la posici√≥n (x, y) en la matriz m.<br> /NOBR/
      </blockquote>
      Notas:
      - (0, 0) representa la posici√≥n de m√°s arriba e izda.
      - cuidado con las esquinas, fila superior, etc.! (se<br> supone un tablero finito, y plano)
      Ejemplo de base en: <a href="examples/juego-vida-01-esqueleto.py" target="_blank">juego-vida-01-esqueleto.py</a>
      @CLASS@ ejercicio-3

      # Par√°metros y argumentos (cont.)
      ## Valor por defecto
      <u>Nota importante</u>: evitar valores <em>mutables</em> como
      valor por defecto (ej. lista, vac√≠a o no) y usar en su
      lugar None o cadenas, y dentro de la funci√≥n "ajustarlo".
      Porque podr√≠amos modificar el valor sin querer! (<a href="https://docs.python.org/3/faq/programming.html#why-are-default-values-shared-between-objects" target="_blank">Doc</a>)
      .
      Ejemplo:
        def add_oder(name, num_items, special_notes={'discount': 0}):
          # Ser√≠a mejor haber tenido arriba special_notes = None y:
          # current_notes = special_notes or {'discount': 0}
          ...
          price = ... * special_notes['discount']
          # En este caso no hay problemas si <u>s√≥lo leemos</u> su valor

      Ejemplo
        # Funci√≥n que usa (mal!) un valor por defecto mutable
        def my_func(s = [ "au revoir" ]):
            print(">>my_func():", s)
            s[0] = "hola"
        
        x = [ "hello" ]
        my_func(x)
        print(x)
        my_func()
        print(x)
        my_func()
        print(x)  # COMPROBAR qu√© se espera y qu√© ocurre aqu√≠
      En la segunda invocaci√≥n sin par√°metro, no es lo esperado!

      <!-- EJERCICIO-PARA-CLASE -->
      # Ejercicio 4: par√°metros<a href="#ejercicio-4" class="link-anchor"> # </a>
      <blockquote>Crear una serie de <u>funciones</u> con par√°metros, para c√°lculos sencillos.</blockquote>
      - Calcular y devolver el valor del IRPF para un salario base (por ejemplo<br> mensual) y tipo (porcentaje) recibidos como par√°metros<br> Ejemplo de uso esperado: x = calcula_irpf(1000.0, 12.5)
      - Igual, pero suponiendo un tipo de IRPF por defecto si no se recibe
      - Igual, pero permitiendo que los dos par√°metros se usen por nombre<br> (y por tanto, si se desea, en desorden)
      - Adem√°s, comprobar si los dos par√°metros son flotantes, y si no,<br> devolver None
      - A√±adir un tercer par√°metro opcional (booleano) que indique si se<br> debe calcular el IRPF prorrateando las pagas extras
      - A√±adir a la definici√≥n de la funci√≥n una Docstring adecuada
      @CLASS@ ejercicio-4

      ## *args y **kwargs
      Avanzado: tupla y diccionario que "agrupan"
      todos los par√°metros recibidos, por ejemplo
      para pas√°rselos a su vez a otra funci√≥n:
        def f(x, *args, **kwargs):
            ...
            kwargs['width'] = 14.3  # se pueden modificar
            ...
            g(x, *args, **kwargs)
      .
      args para los posicionales, kwargs los keyword
      Veremos m√°s adelante un uso similar m√°s frecuente

      Ejemplo:
        def my_print(*args, **kwargs):
            # separador para print(), por defecto " "
            kwargs['sep'] = ""
            print(*args, **kwargs)
      .
      Funci√≥n que recibe n par√°metros, y es un "sustituto"
      de print() pero modificando su comportamiento

      # Alcance (cont.)
      ## Composici√≥n
      <u>Llamar</u> a una funci√≥n dentro de otra
        def rectangle_area(base, height):
            return base * height
        def triangle_area(base, height):
            return rectangle_area(base, height) / 2
      .
      O tambi√©n esto ("encadenar" llamadas a funciones):
        str(int(5.5))

      ## Anidaci√≥n
      <u>Definir</u> una funci√≥n dentro de otra!
      Es algo poco habitual pero se puede hacer, sobre todo
      si la funci√≥n interior es solamente "auxiliar"...
        def triangle_area(base, height):
            def rectangle_area(base, height):
                return base * height
      .
            return rectangle_area(base, height) / 2
      .
      En este caso, rectangle_area() no es visible "fuera"
      Es decir, su alcance/uso est√° limitado a la 1¬™ funci√≥n

      ! img/recursion.jpg

      # Recursi√≥n o recursividad
      Una funci√≥n que <u>se llama a s√≠ misma</u>. Ejemplo:
      .
        def factorial(n):
        if n == 0:
            # Define our base (trivial) case
            return 1
        else:
            return n * factorial(n - 1)
        
        print(factorial(5))
      .
      Es otra t√©cnica m√°s de tipo "divide y vencer√°s" (...)

      Una forma distinta de verlo, que puede ayudar a entenderlo:
      .
        def factorial_0():
            return 1  # caso base o trivial, termina siempre
        
        def factorial_1():
            return 1 * factorial_0()
        
        def factorial_2():
            return 2 * factorial_1()
        
        def factorial_3():
            return 3 * factorial_2()
        
        (...)

      Proceso para dise√±ar un algoritmo recursivo:
      - <u>Suponer</u> que ya tenemos un algoritmo que nos resuelve una<br> "versi√≥n reducida" del problema
      - Identificar uno o varios subproblemas "triviales" (casos base)
      - <u>Descomponer</u> el problema en uno o m√°s subproblemas que se<br> puedan resolver con el algoritmo que sabemos que ya existe<br> y cuya soluci√≥n vaya aproxim√°ndose a los casos base

      <!-- EJERCICIO-PARA-CLASE (DEMO) -->
      # Ejercicio / demo: recursi√≥n
      <blockquote>Ver paso a paso la ejecuci√≥n para algunas<br> /NOBR/
      funciones recursivas.</blockquote>
      - Factorial
      - C√°lculos arbitrarios "sube y baja"
      - Recorrer en orden inverso una lista
      Ver en papel/pizarra, y/o con <a href="http://pythontutor.com/index.html" target="_blank">pythontutor.com</a>
      .
      C√≥digo en: <a href="examples/recursion-baja_y_sube.py" target="_blank">recursion-baja_y_sube.py</a>

      <!-- EJERCICIO-PARA-CLASE (OPCIONAL) -->
      # Ejercicio 5 <u>(opcional)</u>: copo de nieve Koch<a href="#ejercicio-5" class="link-anchor"> # </a>
      <blockquote>Crear una <u>funci√≥n recursiva</u> que dibuje, usando turtle, un lado<br> /NOBR/
      del fractal de Koch o "copo de nieve".</blockquote>
      Nota: partir del esqueleto inicial dado, que ir√° dibujando el lado
      con niveles de profundidad crecientes (√∫til para depurar).
      Mejora opcional: una vez hecho, modificarlo para que dibuje un
      copo de nieve completo (basado en un tri√°ngulo de 3 lados).
      .
      Ejemplo de base en: <a href="examples/turtle-koch-01-esqueleto.py" target="_blank">turtle-koch-01-esqueleto.py</a>
      .
      Ver m√°s detalles en la siguiente p√°gina, y opcionalmente en:
      : https://en.wikipedia.org/wiki/Koch_snowflake
      @CLASS@ ejercicio-5

      Cada uno de los 6 lados del "Copo de nieve" fractal de Koch es:
      .
      ! https://openbookproject.net/thinkcs/python/english3e/_images/koch_1.png
      .
      ! https://openbookproject.net/thinkcs/python/english3e/_images/koch_2.png
      .
      ! https://openbookproject.net/thinkcs/python/english3e/_images/koch_3.png
      .
      Ejemplo de ampliaci√≥n (zoom) infinita de un lado del fractal:
      .
      ! https://upload.wikimedia.org/wikipedia/commons/6/65/Kochsim.gif
      @ZOOM@ 110

      ## Fractales
      Estructuras auto-similares (...)
      : https://en.wikipedia.org/wiki/Fractal
      .
      Otro ejemplo con c√≥digo (con turtle):
      √Årbol fractal en: <a href="examples/turtle-tree-fractal.py" target="_blank">turtle-tree-fractal.py</a>

      Ejemplo de zoom en el fractal de Mandelbrot:
      ! https://upload.wikimedia.org/wikipedia/commons/a/a4/Mandelbrot_sequence_new.gif

      <!-- EJERCICIO-PARA-CLASE -->
      # Ejercicio 6: potencia de un n√∫mero<a href="#ejercicio-6" class="link-anchor"> # </a>
      <blockquote>Crear una funci√≥n <u>recursiva</u> que calcule la n-√©sima potencia<br> /NOBR/
      de un n√∫mero, y la devuelva.</blockquote>
      Opcional: comprobar que se reciben valores adecuados (type)
      .
      Ejemplo de la forma que puede adoptar:
        def potencia(base, exponente):
            ...
      Al usar entonces <code>print(potencia(2, 8))</code> deber√° obtenerse <samp>256</samp>
      @CLASS@ ejercicio-6

      La recursi√≥n normalmente no hace falta y no se suele usar,
      pero es importante entender c√≥mo funciona.
      .
      IMPORTANTE: es necesario asegurar que la ejecuci√≥n terminar√°
      en un n√∫mero peque√±o de niveles de llamada (Python: &lt; 1000).
      Si una funci√≥n se llama a s√≠ misma indirectamente, es lo mismo
      .
      TODAS las funciones recursivas pueden transformarse en otra
      equivalente con bucles; generalmente m√°s r√°pida que la que
      era recursiva, pero a veces m√°s compleja de escribir/leer!

      Cu√°ndo es realmente √∫til / adecuado utilizar la recursi√≥n?
      - Cuando el c√≥digo fuente queda m√°s sencillo y corto<br> (pensar en depuraci√≥n, facilidad de probar y leer...)
      - (Y) Cuando el n√∫mero de niveles de prof. es "peque√±o"
      - (Y) (Opcional, pero deseable) Cuando la soluci√≥n al<br> problema de nivel n-1 es comparativamente bastante<br> m√°s r√°pida (menos costosa) que la del n

      Ejemplos:
      Para recorrer por completo el sistema de ficheros (carpetas dentro de
      carpetas!) o cualquier estructura de datos similar (√°rboles, etc.)
      Ejemplo para procesar listas de listas recursivamente: <a href="https://openbookproject.net/thinkcs/python/english3e/recursion.html#processing-recursive-number-lists" target="_blank">aqu√≠</a> (...)
      .
      Para resolver un problema en el que la solcu√≥n en forma recursiva
      sea la m√°s clara (f√°cil de entender) sin perder mucha eficiencia,
      como por ejemplo ordenar una lista que est√© casi ordenada al inicio
        [5, 2, 1, 3, 4,    11, 19, 18, 12, 16]
      .
      Factorial de un n√∫mero? NO ES EL MEJOR USO, salvo para aprender,
      porque lo de "c√≥digo sencillo" es opinable, lo del "numero de niveles
      peque√±o" no lo cumple (para n√∫meros grandes), y lo de la rapidez del
      subproblema en realidad tampoco. Lo que indica que es mejor un bucle!

      Otro ejemplo: funci√≥n que reciba un entero n y nos
      devuelva el n-√©simo n√∫mero de la serie de Fibonacci.
      : https://es.wikipedia.org/wiki/Serie_de_Fibonacci
      Nota: la serie de Fibonacci es: 0, 1, 1, 2, 3, 5, 8, 13...
      .
        def fibonacci(n):
            if n <= 0:  # Caso base (trivial) 1
                return 0
            elif n == 1:  # Caso base (trivial) 2
                return 1
            else:
                return fibonacci(n-2) + fibonacci(n-1)
      .
      √âste es un ejemplo de uso de recursi√≥n por sencillez y brevedad,
      aunque el programa resultante es <u>mucho m√°s lento</u> que un bucle!

      <!-- EJERCICIO-PARA-CLASE (OPCIONAL) -->
      # Ejercicio 7 <u>(opcional)</u>: billetes<a href="#ejercicio-7" class="link-anchor"> # </a>
      <blockquote> Dispones de los siguentes billetes:<br> /NOBR/
      3 x 20‚Ç¨, 5 x 10‚Ç¨, 2 x 5‚Ç¨.<br> /NOBR/
      Calcula todas las posibles formas de cambiar<br> /NOBR/
      un billete de 100‚Ç¨ con ellos.</blockquote>
      Ejercicio avanzado...
      Encontrar una soluci√≥n <u>usando recursi√≥n</u>.
      Opcional (m√°s complejo?): hacerlo tambi√©n sin.
      .
      Pistas: son <u>combinaciones</u>; no dar resultados
      repetidos; salen tres resultados con esos datos.
      <!-- https://realpython.com/python-itertools/#et-tu-brute-force -->
      <!-- {(20, 20, 20, 10, 10, 10, 10), (20, 20, 10, 10, 10, 10, 10, 5, 5), (20, 20, 20, 10, 10, 10, 5, 5)} -->
      @CLASS@ ejercicio-7
      <!-- SOLUCI√ìN YO: billetes-recursion.py -->
      <!-- PENDIENTE: subir y enlazar soluci√≥n y URL de realpython -->

      # Iteradores
      Tipo de objetos que representan un stream (flujo) de datos,
      y nos van proporcionando sucesivos elementos
        it = iter([1, 2, 3])  # produce un iterador para la lista
      El iterador es similar a un rango, no podemos verlo "tal cual"
      Pero s√≠ utilizarlos, por ejemplo (y sobre todo) en bucles for
        for i in it:
            ...
      En realidad los est√°bamos usando siempre, a√∫n sin saberlo:
        for i in [1, 2, 3]:  # de hecho equivale a lo siguiente
        for i in iter([1, 2, 3]):
            ...

      D√≥nde m√°s se usan: ej. la funci√≥n list()
      se puede usar para convertir cadenas,
      diccionarios (ojo: s√≥lo las claves),
      tuplas, y otros similares, en una lista.
      En realidad trabaja con <em>iterables</em>
      (iteradores, secuencias, generadores...)
      .
      Va consumiendo el "contenido" del iterador
        list(range(5))
      <samp>[0, 1, 2, 3, 4]</samp>
        list("hola")

      Lo mismo para otros tipos de colecciones:
        str()  # espera, como las siguientes, un iterable
        tuple()
        set()
        dict()  # Ojo, espera iterables de tuplas clave - valor

      ## Avanzado: enumerate()
      Para comodidad en los bucles, podemos esusar esta funci√≥n
      que gestiona la variable "contadora" por nosotros
      Ejemplo:
        for i, word in enumerate(['hola', 'que', 'tal']):
            print(f"At index {i} the item is {word}")

      ## Avanzado: m√≥dulo <em>itertools</em>
      Tema algo complejo (...) Es un m√≥dulo que define
      <em>"functions that ‚Äúoperate‚Äù on iterators to
      produce more complex iterators"</em>
      .
      Ejemplo:
        list(<u>zip</u>([1, 2, 3], ['a', 'b', 'c']))
      <samp>[(1, 'a'), (2, 'b'), (3, 'c')]</samp>
      .
      Nota: <u>zip</u> y <u>map</u> (lo veremos) son "built-ins"
      En itertools tenemos otros similares para otras cosas

      Otro ejemplo:
      Iterador que nos da los n√∫meros impares: se
      comporta similar a range() pero sin fin...
        import itertools
        odds = itertools.<u>count</u>(start=1, step=2)
        while True:
            print(next(odds))

      # Ejercicios extra
      <!-- REFERENCIA-INTERNA-A-MODULO-4 -->
      - Cualquiera de los ejercicios ya hechos, convertir el c√≥digo que<br> resulte adecuado (elegir cu√°l...!) en una o varias funciones.<br> Sobre todo, recomend.: producto matricial: <a href="M√≥dulo 4. Estructuras de datos.html#ejercicio-4-bis" target="_blank">M√≥dulo 4, ejcio. 4-bis</a>
      - Dibujar otros fractales con turtle: tri√°ngulo de Sierpinski, Cesaro...<br> <a href="https://openbookproject.net/thinkcs/python/english3e/recursion.html#exercises" target="_blank">openbookproject.net/thinkcs/python/english3e/recursion...</a>
      - Partiendo de lo ya hecho para ver si un n√∫mero es primo (M√≥dulo 3),<br> modificarlo usando funciones, y a√±adir otra que obtenga los factores<br> divisores de un n√∫mero
      <ul><li>Repasar los ejercicios extra de los M√≥dulos 3 y 4, del libro <a href="https://openbookproject.net/thinkcs/python/english3e/" target="_blank">"How to<br> Think Like a Computer Scientist..."</a>, omitidos porque requer√≠an usar<br> funciones, y adem√°s los siguientes (nuevos):
      <ul><li><a href="https://openbookproject.net/thinkcs/python/english3e/functions.html#exercises" target="_blank">https://openbookproject.net/thinkcs/python/english3e/functions...</a></li></ul> /NOBR/
      <ul><li><a href="https://openbookproject.net/thinkcs/python/english3e/fruitful_functions.html#exercises" target="_blank">https://openbookproject.net/thinkcs/python/english3e/fruitful...</a></li></ul></li></ul> /NOBR/

      ## Ejercicios extra m√°s avanzados
      - Variaci√≥n del de los billetes, con n√∫mero ilimitado de cada uno
      - Complejo: ordenar una lista de enteros, usando recursi√≥n
      - M√°s ejercicios con itertools en: <a href="https://realpython.com/python-itertools/" target="_blank">realpython.com/python-itertools</a><br> Tienen el enunciado <u>y la soluci√≥n</u> (OJO, el de los billetes tambi√©n<br>aparece con soluci√≥n pero no recursiva, usando itertools).<br> NOTA: los del final ("Analyzing the S&P500" y "Building Relay...")<br> son m√°s avanzados y requieren trabajar con ficheros (M√≥dulo 9)

      # Referencias
      Como otras veces, un buen resumen de lo principal y algunos ejercicios al final:
      : https://openbookproject.net/thinkcs/python/english3e/functions.html
      Continuaci√≥n sobre funciones (temas recomend.: 6.1 hasta 6.6, no m√°s), y ejercicios;
      los ejercicios usan "unit tests" que por ahora no hemos visto, se pueden hacer pero
      entendiendo los tests dados como una "explicaci√≥n" del comportamiento esperado:
      : https://openbookproject.net/thinkcs/python/english3e/fruitful_functions.html

    </pre>
  </body>
</html>
